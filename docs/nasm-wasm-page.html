<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <!--link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="{{ url_for('static', filename='bridge.js') }}"></script>
    <script src="{{ url_for('static', filename='frontend.js') }}"></script-->
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="coc-nasm-favison.svg" sizes="48x48">
    <script src="bridge.js"></script>
    <!--link rel="shortcut icon" href="favicon.ico" type="image/x-icon"-->

    <link rel="stylesheet" href="highlighters/luahighlight/styles/github-dark.min.css">
    <link rel="stylesheet" href="highlighters/x86asmhighlighters/styles/github-dark.min.css">
    <title>See also</title>
  </head>
  <body id="bodie">
    <header>
      <div id="menubox">
        <nav>
          <ul>
            <li><button id="light">Change background</button></li>
            <br>
            <li><a href="index.html" title="Home"><img src="coc-nasm-favison.svg" /></a></li>
            <li><a href="installation_for_vscode.html">Installation (VSCode)</a></li>
            <li><a href="installation_for_coc.html">Installation (CoC)</a></li>
            <li><a href="installation_for_nvim.html">Installation (nvim plugins)</a></li>
            <li><a href="snippets.html">Snippets</a></li>
            <li><a href="completions.html">Completions</a></li>
            <li><a href="see_also.html">See also</a></li>
          </ul>
        </nav>
    </div>
    </header>
    <main>
      <section>
        <h1 id="testtitle">nasm-to-wasm installation</h1>
        <p class="fakedefault"><i>I have not supported other architectures yet <b>with the exception of amd64</b>. In the future, I promise I will configure my apt repo soon.</i></p>
      </section>
        
      <h2 class="fakedefault"><code>nasm-to-wasm</code> dependencies:</h2>
      <ol class="fakedefault">
        <li><a href="https://python.org" style="color: blue;">Python3</a></li>
        <li><a href="https://github.com/WebAssembly/wabt" style="color: blue;">WebAssembly Binary Toolkit</a></li>
      </ol>
      <h2 class="fakedefault">Install nasm-to-wasm:</h2>
      <h3 class="fakedefault">For Debian-based Linux:</h3>
      <p class="fakedefault">Add a repository into Advanced Package Tool, the update and install <code>nasm-to-wasm</code>:</p>
      <p class="c3">Bash</p>
      <section class="nvimcodeinstallation">
        <div class="c">
          <p class="c2"><img src="clipboard.svg" alt="" class="copy-btn">Copy</p>
        </div>
        <pre>
          <code class="codeblock">curl -fsSL https://who5673.github.io/coc-nasm-web/deb/repo/coc-nasm-website.gpg | sudo gpg --dearmor -o /usr/share/keyrings/coc-nasm-web.gpg
echo "deb [signed-by=/usr/share/keyrings/coc-nasm-web.gpg arch=amd64] https://who5673.github.io/coc-nasm-web/deb/repo $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/coc-nasm-web.list
sudo apt update && sudo apt install nasm-to-wasm</code>
        </pre>
      </section>
      
      <p class="fakedefault">If the codename is not supported, use <code>stable</code> as an alternative (not recommend if <code>lsb_release -cs</code> returns a supported codename):</p>
      <p class="c3">Bash</p>
      <section class="nvimcodeinstallation">
        <div class="c">
          <p class="c2"><img src="clipboard.svg" alt="" class="copy-btn">Copy</p>
        </div>
        <pre>
          <code class="codeblock">echo "deb [signed-by=/usr/share/keyrings/coc-nasm-website.gpg arch=amd64] https://who5673.github.io/coc-nasm-web/deb/repo stable main" | sudo tee /etc/apt/sources.list.d/coc-nasm-web.list</code>
        </pre>
      </section>
      <h3 class="fakedefault">For other Operating System:</h3>
      <p class="fakedefault"><b>Step 1</b>: Go to <a href="https://github.com/Who5673/coc-nasm-web/blob/main/docs/deb/repo/nasm-to-wasm/usr/bin/nasm-to-wasm" target="_blank">this page in coc-nasm-web github repo.</a></p>
      <p class="fakedefault"><b>Step 2</b>: In the website, click the download button like the image below:</p>
      <picture>
        <source srcset="images/display.png" type="image/png">
        <img alt="" title="Screenshot image"  width="1366" height="768.375">
      </picture>
      <p class="fakedefault">The <code>nasm-to-wasm</code> downloaded will be in <code>~/Downloads</code> like this:</p>
      <picture>
        <source srcset="images/downloaded_file.png" type="image/png">
        <img alt="" title="Screenshot image">
      </picture>
      <p class="fakedefault"><b>Step 3:</b> Run the script using Python Interpreter:</p>
      <p class="c3">Bash</p>
      <section class="nvimcodeinstallation">
        <div class="c">
          <p class="c2"><img src="clipboard.svg" alt="" class="copy-btn">Copy</p>
        </div>
        <pre>
          <code class="codeblock"># For Windows, run this script with python3:
python3 nasm-to-wasm.py

# For Unix-based system, provide the script with the permission of executing, then run directly the script:
chmod +x nasm-to-wasm
./nasm-to-wasm</code>
        </pre>
      </section>
      <h2 class="fakedefault">Establish your first Netwide Assembler (NASM) program and then compile it into WASM:</h2>
      <p class="fakedefault"><i>This compiler is not as good as the real NASM one. Therefore, many commands cannot be supported because of the difference between WebAssembly Text and Netwide Assembler architectures.</i></p>
      <h3 class="fakedefault">Step 1: Take down Netwide Assembler script:</h3>
      <p class="fakedefault">Example filename: <code>main.nasm</code></p>
      <p class="c3">NASM</p>
      <section class="nvimcodeinstallation">
        <div class="c">
          <p class="c2"><img src="clipboard.svg" alt="" class="copy-btn">Copy</p>
        </div>
        <pre>
          <code class="codeblock">segment .text
  global sum

sum:
  mov rax, rdi
  add rax, rsi
  ret</code>
        </pre>
      </section>
      <h3 class="fakedefault">Step 2: Choose one of 2 options below:</h3>
      <h4 class="fakedefault">Option 1: Compile into WebAssembly Binary directly:</h4>
      <p class="c3">Bash</p>
      <section class="nvimcodeinstallation">
        <div class="c">
          <p class="c2"><img src="clipboard.svg" alt="" class="copy-btn">Copy</p>
        </div>
        <pre>
          <code class="codeblock">nasm-to-wasm -i main.nasm -o main.wasm</code>
        </pre>
      </section>
      <h4 class="fakedefault">Option 2: Compile into WebAssembly Text Format (WAT), then use <code>wat2wasm</code> to compile the WAT script:</h4>
      <p class="fakedefault">(This is how the <code>nasm-to-wasm</code> compiler works)</p>
      <p class="c3">Bash</p>
      <section class="nvimcodeinstallation">
        <div class="c">
          <p class="c2"><img src="clipboard.svg" alt="" class="copy-btn">Copy</p>
        </div>
        <pre>
          <code class="codeblock">nasm-to-wasm -i main.nasm -o main.wat
wat2wasm main.wat -o main.wasm</code>
        </pre>
      </section>
      <p class="fakedefault">You will also receive a JavaScript file like this <b><code>main.js</code></b>:</p>
      <p class="c3">JavaScript</p>
      <section class="nvimcodeinstallation">
        <div class="c">
          <p class="c2"><img src="clipboard.svg" alt="" class="copy-btn">Copy</p>
        </div>
        <pre>
          <code class="codeblock">export async function loadWasm() {
  // Load WebAssembly normal functions:
  const response = await fetch("main.wasm");
  const bytes = await response.arrayBuffer();
  const result = await WebAssembly.instantiate(bytes);
  return result.instance;
}

export default async function nasmToWasmInit() {
  const instance = await loadWasm();
  globalThis.sum = instance.exports.sum

  return instance;
};</code>
        </pre>
      </section>
      <h3 class="fakedefault">Step 3: Test the script inside a HTML file:</h3>
      <p class="fakedefault">Example file: <code>index.html</code></p>
      <p class="c3">HTML</p>
      <section class="nvimcodeinstallation">
        <div class="c">
          <p class="c2"><img src="clipboard.svg" alt="" class="copy-btn">Copy</p>
        </div>
        <pre>
          <code class="codeblock">&lt;!DOCTYPE html>
&lt;html lang="en">
  &lt;head>
    &lt;meta charset="UTF-8">
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0">
    &lt;title>Netwide Document&lt;title>
    &lt;!--I suggest finding an image file and link it into HTML as a favicon in order to clear the favicon.ico error in the page, for example:--&gt;
    &lt;link rel="icon" type="image/png" href="example_image.png"&gt;
  &lt;/head>
  &lt;body>
    &lt;script type="module" src="frontend.js">&lt;script> &lt;!--Example script--&gt;
  &lt;/body>
&lt;/html></code>
        </pre>
      </section>

      <p class="c3">JavaScript</p>
      <section class="nvimcodeinstallation">
        <div class="c">
          <p class="c2"><img src="clipboard.svg" alt="" class="copy-btn">Copy</p>
        </div>
        <pre>
          <code class="codeblock">import nasmToWasmInit from "./main.js";

await nasmToWasmInit();   // Load the function from the WebAssembly Binary asynchorously
console.log(sum(5, 3));   // Must return 8</code>
        </pre>
      </section>
    </main>
    <footer>
      <section>
        <hr>
        <p style="font-family: sans-serif;">Copyright &copy; 2025 July by who5673. All rights served.</p>
        <h1 style="font-family: sans-serif;">LICENSE</h1>
        <a style="font-weight: 400; font-family: Arial, Helvetica, sans-serif;" href="../LICENSE">MIT</a>
      </section>
    </footer>
    <script src="highlighters/luahighlight/highlight.min.js"></script>
    <script src="highlighters/bashhighlight/languages/bash.min.js"></script>
    <script src="highlighters/x86asmhighlighters/languages/x86asm.min.js"></script>
    <script src="highlighters/wasmhighlight/languages/wasm.min.js"></script>
    <script src="highlighters/webscripthighlight/languages/javascript.min.js"></script>
    <script src="highlighters/html_css_md_highlight/languages/xml.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script type="module" src="frontend.js"></script>
  </body>
</html>
